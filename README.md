# UP Packages

Тулза для апа пакетов под задачи. Выполняет следующее:
* Принимает список задач и пакеты которые нужно апнуть к этим задачам.
* Сверяет версии, если версии разные, то берет максимальную.
* Устаналивает пакеты, коммитит изменения, пушит в gitlab.
* Создает мр в котором сразу выставляет апрувером тестировщика.
* Можно указать из какой ветке и в какую ветку должен создаваться merge request.


Также можно запускать повторно, чтоб апнуть пакеты еще раз, если появились изменения.

## Установка

```bash
npm ci
```

## Использование

Создать .env файл с содержимым:
```bash
GITLAB_TOKEN=TOKEN(взять можно из профиля в гитлабе)
```

Скопировать `config.example.yaml` в `config.yaml`.
Поменять в `config.yaml` в объекте `tasks` содержимое на нужное. Поменять в объекте `config`, путь до assr.

Узнать id вашего тестировщика можно, если зайти в его профиль в гитлабе и в ссылке на аватар будет id пользователя.

Запустить `npm start`. Ждать результатов.

## FAQ

**`npm` пишет, что не может найти пакет, хотя он точно есть!**  
Скрипт нужно запускать через `npm` или через `node ./src/index.js`. Не смог победить проблему нормально, но почему-то не подхватывает токены безопастности если запустить через `yarn`.

**Забыл/а поменять id тестировщика, теперь менять апрувера в мр придется вручную?**  
Можно запустить скрипт еще раз, на всякий случай approval rules обновляется каждый раз.

